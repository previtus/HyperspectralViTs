import numpy as np

AVIRIS_widths = [5.57,5.58,5.58,5.58,5.59,5.59,5.59,5.6,5.6,5.6,5.6,5.61,5.61,5.61,5.62,5.62,5.62,5.62,5.63,5.63,5.63,5.64,5.64,5.64,5.64,5.65,5.65,5.65,5.65,5.66,5.66,5.66,5.66,5.66,5.67,5.67,5.67,5.67,5.68,5.68,5.68,5.68,5.68,5.69,5.69,5.69,5.69,5.69,5.7,5.7,5.7,5.7,5.7,5.7,5.71,5.71,5.71,5.71,5.71,5.71,5.72,5.72,5.72,5.72,5.72,5.72,5.72,5.73,5.73,5.73,5.73,5.73,5.73,5.73,5.73,5.74,5.74,5.74,5.74,5.74,5.74,5.74,5.74,5.74,5.75,5.75,5.75,5.75,5.75,5.75,5.75,5.75,5.75,5.75,5.76,5.76,5.76,5.76,5.76,5.76,5.76,5.76,5.76,5.76,5.76,5.76,5.76,5.77,5.77,5.77,5.77,5.77,5.77,5.77,5.77,5.77,5.77,5.77,5.77,5.77,5.77,5.77,5.77,5.77,5.77,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.78,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.79,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.8,5.81,5.81,5.81,5.81,5.81,5.81,5.81,5.81,5.81,5.81,5.81,5.81,5.81,5.81,5.81,5.81,5.81,5.81,5.81,5.81,5.81,5.82,5.82,5.82,5.82,5.82,5.82,5.82,5.82,5.82,5.82,5.82,5.82,5.82,5.82,5.82,5.82,5.83,5.83,5.83,5.83,5.83,5.83,5.83,5.83,5.83,5.83,5.83,5.83,5.83,5.84,5.84,5.84,5.84,5.84,5.84,5.84,5.84,5.84,5.84,5.84,5.84,5.85,5.85,5.85,5.85,5.85,5.85,5.85,5.85,5.85,5.86,5.86,5.86,5.86,5.86,5.86,5.86,5.86,5.86,5.87,5.87,5.87,5.87,5.87,5.87,5.87,5.87,5.88,5.88,5.88,5.88,5.88,5.88,5.88,5.88,5.89,5.89,5.89,5.89,5.89,5.89,5.89,5.9,5.9,5.9,5.9,5.9,5.9,5.9,5.91,5.91,5.91,5.91,5.91,5.91,5.92,5.92,5.92,5.92,5.92,5.92,5.93,5.93,5.93,5.93,5.93,5.93,5.94,5.94,5.94,5.94,5.94,5.95,5.95,5.95,5.95,5.95,5.95,5.96,5.96,5.96,5.96,5.96,5.97,5.97,5.97,5.97,5.97,5.98,5.98,5.98,5.98,5.98,5.99,5.99,5.99,5.99,5.99,6.0,6.0,6.0,6.0,6.01,6.01,6.01,6.01,6.01,6.02,6.02,6.02,6.02,6.03]
AVIRIS_wavelenghts = [376.44,381.45,386.46,391.47,396.47,401.48,406.49,411.5,416.51,421.52,426.53,431.54,436.54,441.55,446.56,451.57,456.58,461.59,466.6,471.6,476.61,481.62,486.63,491.64,496.65,501.66,506.67,511.67,516.68,521.69,526.7,531.71,536.72,541.73,546.73,551.74,556.75,561.76,566.77,571.78,576.79,581.8,586.8,591.81,596.82,601.83,606.84,611.85,616.86,621.86,626.87,631.88,636.89,641.9,646.91,651.92,656.93,661.93,666.94,671.95,676.96,681.97,686.98,691.99,696.99,702.0,707.01,712.02,717.03,722.04,727.05,732.06,737.06,742.07,747.08,752.09,757.1,762.11,767.12,772.12,777.13,782.14,787.15,792.16,797.17,802.18,807.19,812.19,817.2,822.21,827.22,832.23,837.24,842.25,847.25,852.26,857.27,862.28,867.29,872.3,877.31,882.32,887.32,892.33,897.34,902.35,907.36,912.37,917.38,922.39,927.39,932.4,937.41,942.42,947.43,952.44,957.45,962.45,967.46,972.47,977.48,982.49,987.5,992.51,997.52,1002.52,1007.53,1012.54,1017.55,1022.56,1027.57,1032.58,1037.58,1042.59,1047.6,1052.61,1057.62,1062.63,1067.64,1072.65,1077.65,1082.66,1087.67,1092.68,1097.69,1102.7,1107.71,1112.71,1117.72,1122.73,1127.74,1132.75,1137.76,1142.77,1147.78,1152.78,1157.79,1162.8,1167.81,1172.82,1177.83,1182.84,1187.84,1192.85,1197.86,1202.87,1207.88,1212.89,1217.9,1222.91,1227.91,1232.92,1237.93,1242.94,1247.95,1252.96,1257.97,1262.97,1267.98,1272.99,1278.0,1283.01,1288.02,1293.03,1298.04,1303.04,1308.05,1313.06,1318.07,1323.08,1328.09,1333.1,1338.1,1343.11,1348.12,1353.13,1358.14,1363.15,1368.16,1373.17,1378.17,1383.18,1388.19,1393.2,1398.21,1403.22,1408.23,1413.23,1418.24,1423.25,1428.26,1433.27,1438.28,1443.29,1448.3,1453.3,1458.31,1463.32,1468.33,1473.34,1478.35,1483.36,1488.36,1493.37,1498.38,1503.39,1508.4,1513.41,1518.42,1523.43,1528.43,1533.44,1538.45,1543.46,1548.47,1553.48,1558.49,1563.49,1568.5,1573.51,1578.52,1583.53,1588.54,1593.55,1598.56,1603.56,1608.57,1613.58,1618.59,1623.6,1628.61,1633.62,1638.62,1643.63,1648.64,1653.65,1658.66,1663.67,1668.68,1673.69,1678.69,1683.7,1688.71,1693.72,1698.73,1703.74,1708.75,1713.75,1718.76,1723.77,1728.78,1733.79,1738.8,1743.81,1748.82,1753.82,1758.83,1763.84,1768.85,1773.86,1778.87,1783.88,1788.88,1793.89,1798.9,1803.91,1808.92,1813.93,1818.94,1823.95,1828.95,1833.96,1838.97,1843.98,1848.99,1854.0,1859.01,1864.02,1869.02,1874.03,1879.04,1884.05,1889.06,1894.07,1899.08,1904.08,1909.09,1914.1,1919.11,1924.12,1929.13,1934.14,1939.15,1944.15,1949.16,1954.17,1959.18,1964.19,1969.2,1974.21,1979.21,1984.22,1989.23,1994.24,1999.25,2004.26,2009.27,2014.28,2019.28,2024.29,2029.3,2034.31,2039.32,2044.33,2049.34,2054.34,2059.35,2064.36,2069.37,2074.38,2079.39,2084.4,2089.41,2094.41,2099.42,2104.43,2109.44,2114.45,2119.46,2124.47,2129.47,2134.48,2139.49,2144.5,2149.51,2154.52,2159.53,2164.54,2169.54,2174.55,2179.56,2184.57,2189.58,2194.59,2199.6,2204.6,2209.61,2214.62,2219.63,2224.64,2229.65,2234.66,2239.67,2244.67,2249.68,2254.69,2259.7,2264.71,2269.72,2274.73,2279.73,2284.74,2289.75,2294.76,2299.77,2304.78,2309.79,2314.8,2319.8,2324.81,2329.82,2334.83,2339.84,2344.85,2349.86,2354.86,2359.87,2364.88,2369.89,2374.9,2379.91,2384.92,2389.93,2394.93,2399.94,2404.95,2409.96,2414.97,2419.98,2424.99,2429.99,2435.0,2440.01,2445.02,2450.03,2455.04,2460.05,2465.06,2470.06,2475.07,2480.08,2485.09,2490.1,2495.11,2500.12]
AVIRIS_names = [int(w) for w in AVIRIS_wavelenghts]
AVIRIS_names[35] = 550
AVIRIS_names[53] = 640
AVIRIS_names[17] = 460
AVIRIS_names = ['TOA_AVIRIS_' + str(a) + 'nm.tif' for a in AVIRIS_names]

methane_target = np.array([[ 3.76440000e+02,  0.00000000e+00], [ 3.81450000e+02,  0.00000000e+00], [ 3.86460000e+02,  0.00000000e+00], [ 3.91470000e+02,  0.00000000e+00], [ 3.96470000e+02,  0.00000000e+00], [ 4.01480000e+02,  2.56095022e-14], [ 4.06490000e+02, -2.10461454e-14], [ 4.11500000e+02,  2.44168967e-14], [ 4.16510000e+02,  1.78914452e-15], [ 4.21520000e+02,  2.75387351e-14], [ 4.26530000e+02, -1.52884987e-14], [ 4.31540000e+02,  1.39220886e-14], [ 4.36540000e+02,  1.78684088e-14], [ 4.41550000e+02,  9.17451476e-15], [ 4.46560000e+02,  1.16747492e-14], [ 4.51570000e+02,  7.67202475e-15], [ 4.56580000e+02,  0.00000000e+00], [ 4.61590000e+02,  0.00000000e+00], [ 4.66600000e+02,  0.00000000e+00], [ 4.71600000e+02,  0.00000000e+00], [ 4.76610000e+02,  0.00000000e+00], [ 4.81620000e+02,  0.00000000e+00], [ 4.86630000e+02,  0.00000000e+00], [ 4.91640000e+02,  0.00000000e+00], [ 4.96650000e+02,  0.00000000e+00], [ 5.01660000e+02,  0.00000000e+00], [ 5.06670000e+02,  0.00000000e+00], [ 5.11670000e+02,  0.00000000e+00], [ 5.16680000e+02,  0.00000000e+00], [ 5.21690000e+02,  0.00000000e+00], [ 5.26700000e+02,  0.00000000e+00], [ 5.31710000e+02,  0.00000000e+00], [ 5.36720000e+02,  0.00000000e+00], [ 5.41730000e+02,  0.00000000e+00], [ 5.46730000e+02,  0.00000000e+00], [ 5.51740000e+02,  0.00000000e+00], [ 5.56750000e+02,  0.00000000e+00], [ 5.61760000e+02,  0.00000000e+00], [ 5.66770000e+02,  0.00000000e+00], [ 5.71780000e+02,  0.00000000e+00], [ 5.76790000e+02,  0.00000000e+00], [ 5.81800000e+02,  0.00000000e+00], [ 5.86800000e+02,  0.00000000e+00], [ 5.91810000e+02,  0.00000000e+00], [ 5.96820000e+02,  0.00000000e+00], [ 6.01830000e+02,  0.00000000e+00], [ 6.06840000e+02,  0.00000000e+00], [ 6.11850000e+02,  0.00000000e+00], [ 6.16860000e+02,  0.00000000e+00], [ 6.21860000e+02,  0.00000000e+00], [ 6.26870000e+02,  0.00000000e+00], [ 6.31880000e+02,  0.00000000e+00], [ 6.36890000e+02,  0.00000000e+00], [ 6.41900000e+02,  0.00000000e+00], [ 6.46910000e+02,  0.00000000e+00], [ 6.51920000e+02,  0.00000000e+00], [ 6.56930000e+02,  0.00000000e+00], [ 6.61930000e+02,  0.00000000e+00], [ 6.66940000e+02,  0.00000000e+00], [ 6.71950000e+02,  0.00000000e+00], [ 6.76960000e+02,  0.00000000e+00], [ 6.81970000e+02,  0.00000000e+00], [ 6.86980000e+02,  0.00000000e+00], [ 6.91990000e+02,  0.00000000e+00], [ 6.96990000e+02,  0.00000000e+00], [ 7.02000000e+02,  0.00000000e+00], [ 7.07010000e+02,  0.00000000e+00], [ 7.12020000e+02,  0.00000000e+00], [ 7.17030000e+02,  0.00000000e+00], [ 7.22040000e+02,  0.00000000e+00], [ 7.27050000e+02,  0.00000000e+00], [ 7.32060000e+02,  0.00000000e+00], [ 7.37060000e+02,  0.00000000e+00], [ 7.42070000e+02,  0.00000000e+00], [ 7.47080000e+02,  0.00000000e+00], [ 7.52090000e+02,  0.00000000e+00], [ 7.57100000e+02,  0.00000000e+00], [ 7.62110000e+02,  0.00000000e+00], [ 7.67120000e+02,  0.00000000e+00], [ 7.72120000e+02,  0.00000000e+00], [ 7.77130000e+02,  0.00000000e+00], [ 7.82140000e+02,  0.00000000e+00], [ 7.87150000e+02,  0.00000000e+00], [ 7.92160000e+02,  0.00000000e+00], [ 7.97170000e+02,  0.00000000e+00], [ 8.02180000e+02,  0.00000000e+00], [ 8.07190000e+02,  0.00000000e+00], [ 8.12190000e+02,  0.00000000e+00], [ 8.17200000e+02,  0.00000000e+00], [ 8.22210000e+02,  0.00000000e+00], [ 8.27220000e+02,  0.00000000e+00], [ 8.32230000e+02,  0.00000000e+00], [ 8.37240000e+02,  0.00000000e+00], [ 8.42250000e+02,  0.00000000e+00], [ 8.47250000e+02,  0.00000000e+00], [ 8.52260000e+02,  0.00000000e+00], [ 8.57270000e+02,  0.00000000e+00], [ 8.62280000e+02,  0.00000000e+00], [ 8.67290000e+02,  0.00000000e+00], [ 8.72300000e+02,  0.00000000e+00], [ 8.77310000e+02,  0.00000000e+00], [ 8.82320000e+02,  0.00000000e+00], [ 8.87320000e+02,  0.00000000e+00], [ 8.92330000e+02,  0.00000000e+00], [ 8.97340000e+02,  0.00000000e+00], [ 9.02350000e+02,  0.00000000e+00], [ 9.07360000e+02,  0.00000000e+00], [ 9.12370000e+02,  0.00000000e+00], [ 9.17380000e+02,  0.00000000e+00], [ 9.22390000e+02,  0.00000000e+00], [ 9.27390000e+02,  0.00000000e+00], [ 9.32400000e+02,  0.00000000e+00], [ 9.37410000e+02,  0.00000000e+00], [ 9.42420000e+02,  0.00000000e+00], [ 9.47430000e+02,  0.00000000e+00], [ 9.52440000e+02,  0.00000000e+00], [ 9.57450000e+02,  0.00000000e+00], [ 9.62450000e+02,  0.00000000e+00], [ 9.67460000e+02,  0.00000000e+00], [ 9.72470000e+02,  0.00000000e+00], [ 9.77480000e+02,  0.00000000e+00], [ 9.82490000e+02,  0.00000000e+00], [ 9.87500000e+02,  0.00000000e+00], [ 9.92510000e+02,  0.00000000e+00], [ 9.97520000e+02,  0.00000000e+00], [ 1.00252000e+03,  0.00000000e+00], [ 1.00753000e+03,  0.00000000e+00], [ 1.01254000e+03,  0.00000000e+00], [ 1.01755000e+03,  0.00000000e+00], [ 1.02256000e+03,  0.00000000e+00], [ 1.02757000e+03,  0.00000000e+00], [ 1.03258000e+03,  0.00000000e+00], [ 1.03758000e+03,  0.00000000e+00], [ 1.04259000e+03,  0.00000000e+00], [ 1.04760000e+03,  0.00000000e+00], [ 1.05261000e+03,  0.00000000e+00], [ 1.05762000e+03,  0.00000000e+00], [ 1.06263000e+03,  0.00000000e+00], [ 1.06764000e+03,  0.00000000e+00], [ 1.07265000e+03,  0.00000000e+00], [ 1.07765000e+03,  0.00000000e+00], [ 1.08266000e+03,  0.00000000e+00], [ 1.08767000e+03,  0.00000000e+00], [ 1.09268000e+03,  0.00000000e+00], [ 1.09769000e+03,  0.00000000e+00], [ 1.10270000e+03,  0.00000000e+00], [ 1.10771000e+03,  0.00000000e+00], [ 1.11271000e+03,  0.00000000e+00], [ 1.11772000e+03,  0.00000000e+00], [ 1.12273000e+03,  0.00000000e+00], [ 1.12774000e+03,  0.00000000e+00], [ 1.13275000e+03,  0.00000000e+00], [ 1.13776000e+03,  0.00000000e+00], [ 1.14277000e+03,  0.00000000e+00], [ 1.14778000e+03,  0.00000000e+00], [ 1.15278000e+03,  0.00000000e+00], [ 1.15779000e+03,  0.00000000e+00], [ 1.16280000e+03,  0.00000000e+00], [ 1.16781000e+03,  0.00000000e+00], [ 1.17282000e+03,  0.00000000e+00], [ 1.17783000e+03,  0.00000000e+00], [ 1.18284000e+03,  0.00000000e+00], [ 1.18784000e+03,  0.00000000e+00], [ 1.19285000e+03,  0.00000000e+00], [ 1.19786000e+03,  0.00000000e+00], [ 1.20287000e+03,  0.00000000e+00], [ 1.20788000e+03,  0.00000000e+00], [ 1.21289000e+03,  0.00000000e+00], [ 1.21790000e+03,  0.00000000e+00], [ 1.22291000e+03,  0.00000000e+00], [ 1.22791000e+03,  0.00000000e+00], [ 1.23292000e+03,  0.00000000e+00], [ 1.23793000e+03,  0.00000000e+00], [ 1.24294000e+03,  0.00000000e+00], [ 1.24795000e+03,  0.00000000e+00], [ 1.25296000e+03,  0.00000000e+00], [ 1.25797000e+03,  0.00000000e+00], [ 1.26297000e+03,  0.00000000e+00], [ 1.26798000e+03,  0.00000000e+00], [ 1.27299000e+03,  0.00000000e+00], [ 1.27800000e+03,  0.00000000e+00], [ 1.28301000e+03,  0.00000000e+00], [ 1.28802000e+03,  0.00000000e+00], [ 1.29303000e+03,  0.00000000e+00], [ 1.29804000e+03,  0.00000000e+00], [ 1.30304000e+03,  0.00000000e+00], [ 1.30805000e+03, -1.09663554e-14], [ 1.31306000e+03, -9.58517789e-15], [ 1.31807000e+03, -1.05118326e-16], [ 1.32308000e+03, -3.90219562e-15], [ 1.32809000e+03, -1.29946182e-15], [ 1.33310000e+03, -1.43025381e-14], [ 1.33810000e+03, -9.34760222e-14], [ 1.34311000e+03, -8.52171093e-13], [ 1.34812000e+03, -7.77284787e-12], [ 1.35313000e+03, -7.09204038e-11], [ 1.35814000e+03, -6.43828185e-10], [ 1.36315000e+03, -5.80163142e-09], [ 1.36816000e+03, -5.17212638e-08], [ 1.37317000e+03, -4.53912695e-07], [ 1.37817000e+03, -3.87341344e-06], [ 1.38318000e+03, -3.19194680e-05], [ 1.38819000e+03, -2.43497031e-04], [ 1.39320000e+03, -1.52218029e-03], [ 1.39821000e+03, -5.45383782e-03], [ 1.40322000e+03, -6.83465676e-03], [ 1.40823000e+03, -1.42957623e-02], [ 1.41323000e+03, -2.36760130e-02], [ 1.41824000e+03, -1.91769435e-02], [ 1.42325000e+03, -2.01097130e-02], [ 1.42826000e+03, -1.65553409e-02], [ 1.43327000e+03, -1.14230532e-02], [ 1.43828000e+03, -6.92309815e-03], [ 1.44329000e+03, -5.12574384e-03], [ 1.44830000e+03, -4.48893630e-03], [ 1.45330000e+03, -3.25208453e-03], [ 1.45831000e+03, -2.77298226e-03], [ 1.46332000e+03, -2.07793662e-03], [ 1.46833000e+03, -2.57164800e-03], [ 1.47334000e+03, -3.05266532e-03], [ 1.47835000e+03, -3.57169295e-03], [ 1.48336000e+03, -1.96239816e-03], [ 1.48836000e+03, -1.28226973e-03], [ 1.49337000e+03, -1.06700130e-03], [ 1.49838000e+03, -7.13959050e-04], [ 1.50339000e+03, -5.65526457e-04], [ 1.50840000e+03, -5.25206004e-04], [ 1.51341000e+03, -4.19624434e-04], [ 1.51842000e+03, -3.27201002e-04], [ 1.52343000e+03, -2.31458812e-04], [ 1.52843000e+03, -1.66401386e-04], [ 1.53344000e+03, -1.22080601e-04], [ 1.53845000e+03, -1.03641930e-04], [ 1.54346000e+03, -9.15757059e-05], [ 1.54847000e+03, -5.89839434e-05], [ 1.55348000e+03, -6.50832387e-05], [ 1.55849000e+03, -7.77736348e-05], [ 1.56349000e+03, -1.00232326e-04], [ 1.56850000e+03, -7.47397676e-05], [ 1.57351000e+03, -4.81290563e-05], [ 1.57852000e+03, -4.15632566e-05], [ 1.58353000e+03, -5.30190230e-05], [ 1.58854000e+03, -9.58622688e-05], [ 1.59355000e+03, -2.21718540e-04], [ 1.59856000e+03, -5.29610584e-04], [ 1.60356000e+03, -1.25866535e-03], [ 1.60857000e+03, -3.05539199e-03], [ 1.61358000e+03, -7.34719347e-03], [ 1.61859000e+03, -1.68090395e-02], [ 1.62360000e+03, -3.55551956e-02], [ 1.62861000e+03, -7.17621510e-02], [ 1.63362000e+03, -1.12774840e-01], [ 1.63862000e+03, -1.38612979e-01], [ 1.64363000e+03, -1.31441423e-01], [ 1.64864000e+03, -1.45354939e-01], [ 1.65365000e+03, -1.16919768e-01], [ 1.65866000e+03, -7.07354429e-02], [ 1.66367000e+03, -2.04135037e-01], [ 1.66868000e+03, -2.34052294e-01], [ 1.67369000e+03, -7.50099417e-02], [ 1.67869000e+03, -7.74131757e-02], [ 1.68370000e+03, -8.48381597e-02], [ 1.68871000e+03, -9.66554940e-02], [ 1.69372000e+03, -1.08576414e-01], [ 1.69873000e+03, -1.19012514e-01], [ 1.70374000e+03, -1.63885819e-01], [ 1.70875000e+03, -1.48248671e-01], [ 1.71375000e+03, -7.55235115e-02], [ 1.71876000e+03, -6.00931418e-02], [ 1.72377000e+03, -1.22007652e-01], [ 1.72878000e+03, -1.33907846e-01], [ 1.73379000e+03, -9.61420719e-02], [ 1.73880000e+03, -7.31756765e-02], [ 1.74381000e+03, -5.52741076e-02], [ 1.74882000e+03, -4.44512545e-02], [ 1.75382000e+03, -3.60118045e-02], [ 1.75883000e+03, -3.50111625e-02], [ 1.76384000e+03, -4.15722281e-02], [ 1.76885000e+03, -5.75349849e-02], [ 1.77386000e+03, -8.12303350e-02], [ 1.77887000e+03, -5.37038364e-02], [ 1.78388000e+03, -4.24244623e-02], [ 1.78888000e+03, -8.13588727e-02], [ 1.79389000e+03, -8.11049542e-02], [ 1.79890000e+03, -2.72744471e-02], [ 1.80391000e+03, -2.29801616e-02], [ 1.80892000e+03, -2.55805843e-02], [ 1.81393000e+03, -4.34998118e-02], [ 1.81894000e+03, -2.96147472e-02], [ 1.82395000e+03, -7.27495467e-03], [ 1.82895000e+03, -3.28090560e-03], [ 1.83396000e+03, -1.77144392e-05], [ 1.83897000e+03, -4.15407536e-07], [ 1.84398000e+03, -1.91620458e-06], [ 1.84899000e+03, -8.30591777e-07], [ 1.85400000e+03, -2.18678684e-07], [ 1.85901000e+03, -4.96353918e-07], [ 1.86402000e+03, -1.53969144e-06], [ 1.86902000e+03, -8.01093390e-07], [ 1.87403000e+03, -4.90547564e-07], [ 1.87904000e+03, -6.83503905e-06], [ 1.88405000e+03, -1.05970209e-05], [ 1.88906000e+03, -1.61793370e-05], [ 1.89407000e+03, -1.55619101e-05], [ 1.89908000e+03, -8.64433985e-06], [ 1.90408000e+03, -3.86600399e-07], [ 1.90909000e+03, -1.92442470e-06], [ 1.91410000e+03, -4.54915675e-05], [ 1.91911000e+03, -3.09481909e-04], [ 1.92412000e+03, -1.13412152e-03], [ 1.92913000e+03, -1.04878779e-03], [ 1.93414000e+03, -1.42025715e-03], [ 1.93915000e+03, -1.07475718e-03], [ 1.94415000e+03, -1.40032725e-03], [ 1.94916000e+03, -8.28522904e-04], [ 1.95417000e+03, -6.82682031e-04], [ 1.95918000e+03, -6.19366264e-04], [ 1.96419000e+03, -7.11607985e-04], [ 1.96920000e+03, -9.93414538e-04], [ 1.97421000e+03, -7.28483567e-04], [ 1.97921000e+03, -6.89555880e-04], [ 1.98422000e+03, -5.71493176e-04], [ 1.98923000e+03, -3.82420359e-04], [ 1.99424000e+03, -1.90036894e-04], [ 1.99925000e+03, -4.08264445e-04], [ 2.00426000e+03, -1.90986461e-04], [ 2.00927000e+03, -1.11678178e-04], [ 2.01428000e+03, -2.59613924e-04], [ 2.01928000e+03, -2.31064313e-04], [ 2.02429000e+03, -1.44065079e-04], [ 2.02930000e+03, -1.09226668e-04], [ 2.03431000e+03, -1.19153665e-04], [ 2.03932000e+03, -4.66551217e-05], [ 2.04433000e+03, -5.33643874e-05], [ 2.04934000e+03, -4.14907501e-05], [ 2.05434000e+03, -3.96316176e-05], [ 2.05935000e+03, -3.42879953e-05], [ 2.06436000e+03, -3.90132557e-05], [ 2.06937000e+03, -3.57520389e-05], [ 2.07438000e+03, -6.57691604e-05], [ 2.07939000e+03, -7.96482279e-05], [ 2.08440000e+03, -1.13970813e-04], [ 2.08941000e+03, -1.10620827e-04], [ 2.09441000e+03, -1.14656065e-04], [ 2.09942000e+03, -1.75536099e-04], [ 2.10443000e+03, -2.39106583e-04], [ 2.10944000e+03, -4.36759593e-04], [ 2.11445000e+03, -8.07148283e-04], [ 2.11946000e+03, -1.62321296e-03], [ 2.12447000e+03, -3.21214038e-03], [ 2.12947000e+03, -5.90984392e-03], [ 2.13448000e+03, -1.15570639e-02], [ 2.13949000e+03, -1.77566746e-02], [ 2.14450000e+03, -2.80732500e-02], [ 2.14951000e+03, -4.55226992e-02], [ 2.15452000e+03, -6.25548777e-02], [ 2.15953000e+03, -8.21936894e-02], [ 2.16454000e+03, -9.27514247e-02], [ 2.16954000e+03, -9.72961350e-02], [ 2.17455000e+03, -9.09099172e-02], [ 2.17956000e+03, -7.97553541e-02], [ 2.18457000e+03, -4.96616099e-02], [ 2.18958000e+03, -3.58600062e-02], [ 2.19459000e+03, -1.05254594e-01], [ 2.19960000e+03, -6.28161041e-01], [ 2.20460000e+03, -4.49894577e-01], [ 2.20961000e+03, -1.01278377e-01], [ 2.21462000e+03, -1.28747257e-01], [ 2.21963000e+03, -2.04251848e-01], [ 2.22464000e+03, -2.42904459e-01], [ 2.22965000e+03, -3.43436430e-01], [ 2.23466000e+03, -4.43260712e-01], [ 2.23967000e+03, -4.92158057e-01], [ 2.24467000e+03, -5.98149549e-01], [ 2.24968000e+03, -6.11769497e-01], [ 2.25469000e+03, -6.84326673e-01], [ 2.25970000e+03, -7.27841156e-01], [ 2.26471000e+03, -7.66610859e-01], [ 2.26972000e+03, -6.71594683e-01], [ 2.27473000e+03, -7.34868996e-01], [ 2.27973000e+03, -6.65362248e-01], [ 2.28474000e+03, -7.84706992e-01], [ 2.28975000e+03, -8.93606432e-01], [ 2.29476000e+03, -1.10922543e+00], [ 2.29977000e+03, -1.19302907e+00], [ 2.30478000e+03, -9.82607099e-01], [ 2.30979000e+03, -4.09744014e-01], [ 2.31480000e+03, -6.65415729e-01], [ 2.31980000e+03, -1.49049405e+00], [ 2.32481000e+03, -6.81158907e-01], [ 2.32982000e+03, -6.34187582e-01], [ 2.33483000e+03, -8.72104736e-01], [ 2.33984000e+03, -1.25856606e+00], [ 2.34485000e+03, -1.46358965e+00], [ 2.34986000e+03, -1.52176843e+00], [ 2.35486000e+03, -1.17323945e+00], [ 2.35987000e+03, -6.70087096e-01], [ 2.36488000e+03, -5.98688174e-01], [ 2.36989000e+03, -1.48473098e+00], [ 2.37490000e+03, -1.39839689e+00], [ 2.37991000e+03, -7.35732558e-01], [ 2.38492000e+03, -6.74514181e-01], [ 2.38993000e+03, -7.07964373e-01], [ 2.39493000e+03, -7.43980859e-01], [ 2.39994000e+03, -5.42808146e-01], [ 2.40495000e+03, -5.06046174e-01], [ 2.40996000e+03, -3.32462971e-01], [ 2.41497000e+03, -2.07926989e-01], [ 2.41998000e+03, -2.52202376e-01], [ 2.42499000e+03, -3.30886043e-01], [ 2.42999000e+03, -2.21651331e-01], [ 2.43500000e+03, -1.58812566e-01], [ 2.44001000e+03, -1.35171072e-01], [ 2.44502000e+03, -1.25647194e-01], [ 2.45003000e+03, -1.15123265e-01], [ 2.45504000e+03, -9.27350441e-02], [ 2.46005000e+03, -7.48745807e-02], [ 2.46506000e+03, -4.39597177e-02], [ 2.47006000e+03, -5.24099862e-02], [ 2.47507000e+03, -2.95139415e-02], [ 2.48008000e+03, -2.93237805e-02], [ 2.48509000e+03, -1.90840227e-02], [ 2.49010000e+03, -2.39441505e-02], [ 2.49511000e+03, -3.06423128e-02], [ 2.50012000e+03, -2.82040720e-02]])

def get_idx_from_nearest_band(query):
    min_d = abs(AVIRIS_wavelenghts[0] - query)
    min_i = 0
    for i, wv in enumerate(AVIRIS_wavelenghts):
        d = abs(wv - query)
        if d < min_d:
            min_d = d
            min_i = i
    return min_i


if __name__ == "__main__":
    print("AVIRIS has", len(AVIRIS_widths), "==", len(AVIRIS_wavelenghts), "bands")
    print("from has", AVIRIS_wavelenghts[0], "to", AVIRIS_wavelenghts[-1], "nm")
    print("width on average:", np.mean(AVIRIS_widths), "+-", np.std(AVIRIS_widths))
    print("methane_target", methane_target.shape)
    print("AVIRIS_names has", len(AVIRIS_names), "bands")